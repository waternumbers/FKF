<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Fast Kalman filter — fkf • FKF</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Fast Kalman filter — fkf"><meta property="og:description" content="This function allows for fast and flexible Kalman filtering. Both, the
measurement and transition equation may be multivariate and parameters
are allowed to be time-varying. In addition &amp;#8220;NA&amp;#8221;-values in the
observations are supported. fkf wraps the C-function
FKF which fully relies on linear algebra subroutines contained
in BLAS and LAPACK."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">FKF</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.2.3.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/FKF.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/waternumbers/FKF/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Fast Kalman filter</h1>
    <small class="dont-index">Source: <a href="https://github.com/waternumbers/FKF/blob/HEAD/R/fkf.R" class="external-link"><code>R/fkf.R</code></a></small>
    <div class="hidden name"><code>fkf.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function allows for fast and flexible Kalman filtering. Both, the
measurement and transition equation may be multivariate and parameters
are allowed to be time-varying. In addition “NA”-values in the
observations are supported. <code>fkf</code> wraps the <code>C</code>-function
<code>FKF</code> which fully relies on linear algebra subroutines contained
in BLAS and LAPACK.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">fkf</span><span class="op">(</span><span class="va">a0</span>, <span class="va">P0</span>, <span class="va">dt</span>, <span class="va">ct</span>, <span class="va">Tt</span>, <span class="va">Zt</span>, <span class="va">HHt</span>, <span class="va">GGt</span>, <span class="va">yt</span><span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>a0</dt>
<dd><p>A <code>vector</code> giving the initial value/estimation of the state variable.</p></dd>


<dt>P0</dt>
<dd><p>A <code>matrix</code> giving the variance of <code>a0</code>.</p></dd>


<dt>dt</dt>
<dd><p>A <code>matrix</code> giving the intercept of the transition equation (see <b>Details</b>).</p></dd>


<dt>ct</dt>
<dd><p>A <code>matrix</code> giving the intercept of the measurement equation (see <b>Details</b>).</p></dd>


<dt>Tt</dt>
<dd><p>An <code>array</code> giving the factor of the transition equation (see <b>Details</b>).</p></dd>


<dt>Zt</dt>
<dd><p>An <code>array</code> giving the factor of the measurement equation (see <b>Details</b>).</p></dd>


<dt>HHt</dt>
<dd><p>An <code>array</code> giving the variance of the innovations of the transition equation (see <b>Details</b>).</p></dd>


<dt>GGt</dt>
<dd><p>An <code>array</code> giving the variance of the disturbances of the measurement equation (see <b>Details</b>).</p></dd>


<dt>yt</dt>
<dd><p>A <code>matrix</code> containing the observations. “NA”-values are allowed (see <b>Details</b>).</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>An S3-object of class “fkf”, which is a list with the following elements:</p>


<table class="table table"><tr><td><code>att</code></td><td>A \(m \times n\)-matrix containing the filtered state variables, i.e. att[,t] = \(a_{t|t}\).</td></tr><tr><td><code>at</code></td><td>A \(m \times (n + 1)\)-matrix containing the predicted state variables, i.e. at[,t] = \(a_t\).</td></tr><tr><td><code>Ptt</code></td><td>A \(m \times m \times n\)-array containing the variance of <code>att</code>, i.e. Ptt[,,t] = \(P_{t|t}\).</td></tr><tr><td><code>Pt</code></td><td>A \(m \times m \times (n + 1)\)-array containing the variances of <code>at</code>, i.e. Pt[,,t] = \(P_t\).</td></tr><tr><td><code>vt</code></td><td>A \(d \times n\)-matrix of the prediction errors i.e. vt[,t] = \(v_t\).</td></tr><tr><td><code>Ft</code></td><td>A \(d \times d \times n\)-array which contains the variances of <code>vt</code>, i.e. Ft[,,t] = \(F_t\).</td></tr><tr><td><code>Kt</code></td><td>A \(m \times d \times n\)-array containing the “Kalman gain” i.e. Kt[,,t] = \(k_t\).</td></tr><tr><td><code>logLik</code></td><td>The log-likelihood.</td></tr><tr><td><code>status</code></td><td>A vector which contains the status of LAPACK's <code>dpotri</code> and <code>dpotrf</code>. \((0, 0)\) means successful exit.</td></tr><tr><td><code>sys.time</code></td><td>The time elapsed as an object of class “proc_time”.</td></tr></table></div>
    <div id="details">
    <h2>Details</h2>
    <p><strong>State space form</strong></p>
<p>The following notation is closest to the one of Koopman et al.
The state space model is represented by the transition equation and
the measurement equation. Let \(m\) be the dimension of the state
variable, \(d\) be the dimension of the observations, and \(n\)
the number of observations. The transition equation and the
measurement equation are given by
$$\alpha_{t + 1} = d_t + T_t \cdot \alpha_t + H_t \cdot \eta_t$$ 
$$y_t = c_t + Z_t \cdot \alpha_t + G_t \cdot \epsilon_t,$$
where \(\eta_t\) and \(\epsilon_t\) are iid
\(N(0, I_m)\) and iid \(N(0, I_d)\),
respectively, and \(\alpha_t\) denotes the state
variable. The parameters admit the following dimensions:</p>
<table class="table table"><tr><td>\(\alpha_{t} \in R^{m}\)</td><td>\(d_{t} \in R^m\)</td><td>\(\eta_{t} \in R^m\)</td></tr><tr><td>\(T_{t} \in R^{m \times m}\)</td><td>\(H_{t} \in R^{m \times m}\)</td><td></td></tr><tr><td>\(y_{t} \in R^d\)</td><td>\(c_t \in R^d\)</td><td>\(\epsilon_{t} \in R^d\)</td></tr><tr><td>\(Z_{t} \in R^{d \times m}\)</td><td>\(G_{t} \in R^{d \times d}\)</td><td></td></tr></table><p>Note that <code>fkf</code> takes as input <code>HHt</code> and <code>GGt</code> which
corresponds to \(H_t H_t^\prime\) and \(G_t G_t^\prime\).</p>
<p><!-- % &lt;-------------------------------------&gt; -->
<strong>Iteration:</strong></p>
<p>The filter iterations are implemented using the expected values
$$a_{t} = E[\alpha_t | y_1,\ldots,y_{t-1}]$$
$$a_{t|t} = E[\alpha_t | y_1,\ldots,y_{t}]$$</p>
<p>and variances
$$P_{t} = Var[\alpha_t | y_1,\ldots,y_{t-1}]$$
$$P_{t|t} = Var[\alpha_t | y_1,\ldots,y_{t}]$$</p>
<p>of the state \(\alpha_{t}\) in the following way
(for the case of no NA's):</p>
<p>Initialisation: Set \(t=1\) with \(a_{t} = a0\) and \(P_{t}=P0\)</p>
<p>Updating equations:
$$v_t = y_t - c_t - Z_t a_t$$
$$F_t = Z_t P_t Z_t^{\prime} + G_t G_t^\prime$$
$$K_t = P_t Z_t^{\prime} F_{t}^{-1}$$
$$a_{t|t} = a_t + K_t v_t$$
$$P_{t|t} = P_t - P_t Z_t^\prime K_t^\prime$$</p>
<p>Prediction equations:
$$a_{t+1} = d_{t} + T_{t} a_{t|t}$$
$$P_{t+1} = T_{t} P_{t|t} T_{t}^{\prime} + H_t H_t^\prime$$</p>
<p>Next iteration: Set \(t=t+1\) and goto “Updating equations”.</p>
<p><!-- % &lt;-------------------------------------&gt; -->
<strong>NA-values:</strong></p>
<p>NA-values in the observation matrix <code>yt</code> are supported.  If
  particular observations <code>yt[,i]</code> contain NAs, the NA-values are
  removed and the measurement equation is adjusted accordingly.  When
  the full vector <code>yt[,i]</code> is missing the Kalman filter reduces to
  a prediction step.</p>
<p><!-- % &lt;-------------------------------------&gt; -->
<strong>Parameters:</strong></p>
<p>The parameters can either be constant or deterministic
  time-varying. Assume the number of observations is \(n\)
  (i.e. \(y = (y_t)_{t = 1, \ldots, n}, y_t = (y_{t1}, \ldots,
  y_{td})\)). Then, the parameters admit the following
  classes and dimensions:</p>
<table class="table table"><tr><td><code>dt</code></td><td>either a \(m \times n\) (time-varying) or a \(m \times 1\) (constant) matrix.</td></tr><tr><td><code>Tt</code></td><td>either a \(m \times m \times n\) or a \(m \times m \times 1\) array.</td></tr><tr><td><code>HHt</code></td><td>either a \(m \times m \times n\) or a \(m \times m \times 1\) array.</td></tr><tr><td><code>ct</code></td><td>either a \(d \times n\) or a \(d \times 1\) matrix.</td></tr><tr><td><code>Zt</code></td><td>either a \(d \times m \times n\) or a \(d \times m \times 1\) array.</td></tr><tr><td><code>GGt</code></td><td>either a \(d \times d \times n\) or a \(d \times d \times 1\) array.</td></tr><tr><td><code>yt</code></td><td>a \(d \times n\) matrix.</td></tr></table><p><!-- % &lt;-------------------------------------&gt; -->
  <strong>BLAS and LAPACK routines used:</strong></p>
<p>The <span style="R">R</span> function <code>fkf</code> basically wraps the <code>C</code>-function
  <code>FKF</code>, which entirely relies on linear algebra subroutines
  provided by BLAS and LAPACK. The following functions are used:</p>
<table class="table table"><tr><td>BLAS:</td><td><code>dcopy</code>, <code>dgemm</code>, <code>daxpy</code>.</td></tr><tr><td>LAPACK:</td><td><code>dpotri</code>, <code>dpotrf</code>.</td></tr></table><p><code>FKF</code> is called through the <code>.Call</code> interface.  Internally,
  <code>FKF</code> extracts the dimensions, allocates memory, and initializes
  the <span style="R">R</span>-objects to be returned. <code>FKF</code> subsequently calls
  <code>cfkf</code> which performs the Kalman filtering.</p>
<p>The only critical part is to compute the inverse of \(F_t\)
  and the determinant of \(F_t\). If the inverse can not be
  computed, the filter stops and returns the corresponding message in
  <code>status</code> (see <b>Value</b>). If the computation of the
  determinant fails, the filter will continue, but the log-likelihood
  (element <code>logLik</code>) will be “NA”.</p>
<p>The inverse is computed in two steps:
First, the Cholesky factorization of \(F_t\) is
  calculated by <code>dpotrf</code>. Second, <code>dpotri</code> calculates the
  inverse based on the output of <code>dpotrf</code>. <br>
  The determinant of \(F_t\) is computed using again the
  Cholesky decomposition.</p>

<p>The first element of both <code>at</code> and <code>Pt</code> is filled with the
function arguments <code>a0</code> and <code>P0</code>, and the last, i.e. the (n +
1)-th, element of <code>at</code> and <code>Pt</code> contains the predictions for the next time step.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    

<p>Harvey, Andrew C. (1990). <em>Forecasting, Structural Time Series
  Models and the Kalman Filter</em>.  Cambridge University Press.</p>
<p>Hamilton, James D. (1994). <em>Time Series Analysis</em>.  Princeton
University Press.</p>
<p>Koopman, S. J., Shephard, N., Doornik, J. A. (1999).
<em>Statistical algorithms for models in state space using SsfPack
2.2</em>. Econometrics Journal, Royal Economic Society, vol. 2(1), pages
107-160.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="plot.fkf.html">plot</a></code> to visualize and analyze <code>fkf</code>-objects, <code><a href="https://rdrr.io/r/stats/KalmanLike.html" class="external-link">KalmanRun</a></code> from the stats package, function <code>dlmFilter</code> from package <code>dlm</code>.</p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="co">## &lt;---------------------------------------------------------------------------&gt;</span></span>
<span class="r-in"><span class="co">## Example: Local level model for the Nile's annual flow.</span></span>
<span class="r-in"><span class="co">## &lt;---------------------------------------------------------------------------&gt;</span></span>
<span class="r-in"><span class="co">## Transition equation:</span></span>
<span class="r-in"><span class="co">## alpha[t+1] = alpha[t] + eta[t], eta[t] ~ N(0, HHt)          </span></span>
<span class="r-in"><span class="co">## Measurement equation:</span></span>
<span class="r-in"><span class="co">## y[t] = alpha[t] + eps[t], eps[t] ~  N(0, GGt)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="va">y</span> <span class="op">&lt;-</span> <span class="va">Nile</span></span>
<span class="r-in"><span class="va">y</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">10</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA</span>  <span class="co"># NA values can be handled</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## Set constant parameters:</span></span>
<span class="r-in"><span class="va">dt</span> <span class="op">&lt;-</span> <span class="va">ct</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span> </span>
<span class="r-in"><span class="va">Zt</span> <span class="op">&lt;-</span> <span class="va">Tt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span class="r-in"><span class="va">a0</span> <span class="op">&lt;-</span> <span class="va">y</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>            <span class="co"># Estimation of the first year flow </span></span>
<span class="r-in"><span class="va">P0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span>     <span class="co"># Variance of 'a0'</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## Estimate parameters:</span></span>
<span class="r-in"><span class="va">fit.fkf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/optim.html" class="external-link">optim</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>HHt <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">var</a></span><span class="op">(</span><span class="va">y</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">*</span> <span class="fl">.5</span>,</span>
<span class="r-in">                   GGt <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">var</a></span><span class="op">(</span><span class="va">y</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">*</span> <span class="fl">.5</span><span class="op">)</span>,</span>
<span class="r-in">                 fn <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">par</span>, <span class="va">...</span><span class="op">)</span></span>
<span class="r-in">                 <span class="op">-</span><span class="fu">fkf</span><span class="op">(</span>HHt <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="va">par</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>, GGt <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="va">par</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>, <span class="va">...</span><span class="op">)</span><span class="op">$</span><span class="va">logLik</span>,</span>
<span class="r-in">                 yt <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span>, a0 <span class="op">=</span> <span class="va">a0</span>, P0 <span class="op">=</span> <span class="va">P0</span>, dt <span class="op">=</span> <span class="va">dt</span>, ct <span class="op">=</span> <span class="va">ct</span>,</span>
<span class="r-in">                 Zt <span class="op">=</span> <span class="va">Zt</span>, Tt <span class="op">=</span> <span class="va">Tt</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## Filter Nile data with estimated parameters:</span></span>
<span class="r-in"><span class="va">fkf.obj</span> <span class="op">&lt;-</span> <span class="fu">fkf</span><span class="op">(</span><span class="va">a0</span>, <span class="va">P0</span>, <span class="va">dt</span>, <span class="va">ct</span>, <span class="va">Tt</span>, <span class="va">Zt</span>, HHt <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="va">fit.fkf</span><span class="op">$</span><span class="va">par</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>,</span>
<span class="r-in">               GGt <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="va">fit.fkf</span><span class="op">$</span><span class="va">par</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>, yt <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## Compare with the stats' structural time series implementation:</span></span>
<span class="r-in"><span class="va">fit.stats</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/StructTS.html" class="external-link">StructTS</a></span><span class="op">(</span><span class="va">y</span>, type <span class="op">=</span> <span class="st">"level"</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="va">fit.fkf</span><span class="op">$</span><span class="va">par</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       HHt       GGt </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1385.066 15124.131 </span>
<span class="r-in"><span class="va">fit.stats</span><span class="op">$</span><span class="va">coef</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     level   epsilon </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1599.452 14904.781 </span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## Plot the flow data together with fitted local levels:</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">y</span>, main <span class="op">=</span> <span class="st">"Nile flow"</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/fitted.values.html" class="external-link">fitted</a></span><span class="op">(</span><span class="va">fit.stats</span><span class="op">)</span>, col <span class="op">=</span> <span class="st">"green"</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/ts.html" class="external-link">ts</a></span><span class="op">(</span><span class="va">fkf.obj</span><span class="op">$</span><span class="va">att</span><span class="op">[</span><span class="fl">1</span>, <span class="op">]</span>, start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/start.html" class="external-link">start</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span>, frequency <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/time.html" class="external-link">frequency</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span><span class="op">)</span>, col <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"top"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Nile flow data"</span>, <span class="st">"Local level (StructTS)"</span>, <span class="st">"Local level (fkf)"</span><span class="op">)</span>,</span>
<span class="r-in">       col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"black"</span>, <span class="st">"green"</span>, <span class="st">"blue"</span><span class="op">)</span>, lty <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span class="r-plt img"><img src="fkf-1.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by David Luethi, Philipp Erb, Simon Otziger, Daniel McDonald, Paul Smith.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.4.</p>
</div>

      </footer></div>

  


  

  </body></html>

